{{!< layout}} 

<h3>Dashboard</h3>
<div>
  <div class="col-xl-6">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title mb-0">
          <i class="fas fa-chart-pie"></i>
            Etsy Sales By Month
        </h4>
        <div class="card-body">
          <div class="tab-content p-0">
          <!-- Morris chart - Sales -->
            <div class="chart tab-pane active" id="etsy-month-revenue-chart" style="position: relative; height: 300px;">
              <canvas id="etsy-month-revenue-chart-canvas" height="300" style="height: 300px;"></canvas>                         
            </div>
           </div>
        </div><!-- /.card-body -->
       </div>
    </div>
  </div>
  <div class="col-xl-6">
     <div class="card">
      <div class="card-header">
        <h4 class="card-title mb-0">
          <i class="fas fa-chart-pie"></i>
            Etsy Sales By Quarter
        </h4>
        <div class="card-body">
          <div class="tab-content p-0">
          <!-- Morris chart - Sales -->
            <div class="chart tab-pane active" id="etsy-quarter-revenue-chart" style="position: relative; height: 300px;">
              <canvas id="etsy-quarter-revenue-chart-canvas" height="300" style="height: 300px;"></canvas>                         
            </div>
           </div>
        </div><!-- /.card-body -->
       </div>
    </div>
  </div>
</div>




{{#contentFor "pageScripts"}}
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  <script>
    var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec']
    var etsyMonthlyData = {{{toJSON etsyMonthlyData }}}
    var etsyQuarterlyData = {{{toJSON etsyQuarterlyData }}}
    var squareMonthlyData = {{{toJSON squareMonthlyData }}}
    var squareQuarterlyData = {{{toJSON squareQuarterlyData }}}
    
    
    var etsyMonthlyLabels = etsyMonthlyData.map(function(item){
      return months[Number(item.MonthOfYear) - 1]
    });
    var etsyMonthlyDataPoints = etsyMonthlyData.map(function(item){
      return item.Amount
    });
    
    
    function mapLabels(data, hashName){
      return data.map(function(item){
        return months[Number(item[hashName]) - 1]
      });
    }
    function mapData(data){
      return data.map(function(item){
        return item.Amount
      });
    }
    function buildChart( chartCanvasId, dataOptions, chartOptions, type){
      var canvas = document.getElementById(chartCanvasId).getContext('2d');
      var etsyMonthlySalesChart = new Chart(canvas, { 
          type: type, 
          data: dataOptions, 
          options: chartOptions
        }
      )
    }
  window.addEventListener('load', function () {
    
    buildChart('etsy-quarter-revenue-chart-canvas',
              {
                labels  : mapLabels(etsyQuarterlyData),
                datasets: [
                  {
                    label               : 'Etsy Sales By Month',
                    backgroundColor     : 'rgba(60,141,188,0.9)',
                    borderColor         : 'rgba(60,141,188,0.8)',
                    pointRadius          : false,
                    pointColor          : '#3b8bba',
                    pointStrokeColor    : 'rgba(60,141,188,1)',
                    pointHighlightFill  : '#fff',
                    pointHighlightStroke: 'rgba(60,141,188,1)',
                    data                : etsyMonthlyDataPoints
                  }
                ]
              })

  // Sales chart
  var etsyMonthlySalesChartCanvas = document.getElementById('etsy-month-revenue-chart-canvas').getContext('2d');
  //$('#revenue-chart').get(0).getContext('2d');

  var etsyMonthlySalesChartData = {
    labels  : etsyMonthlyLabels,
    datasets: [
      {
        label               : 'Etsy Sales By Month',
        backgroundColor     : 'rgba(60,141,188,0.9)',
        borderColor         : 'rgba(60,141,188,0.8)',
        pointRadius          : false,
        pointColor          : '#3b8bba',
        pointStrokeColor    : 'rgba(60,141,188,1)',
        pointHighlightFill  : '#fff',
        pointHighlightStroke: 'rgba(60,141,188,1)',
        data                : etsyMonthlyDataPoints
      }
    ]
  }
   var etsyMonthlySalesChartOptions = {
    maintainAspectRatio : false,
    responsive : true,
    legend: {
      display: false
    },
    scales: {
      xAxes: [{
        gridLines : {
          display : false,
        }
      }],
      yAxes: [{
        gridLines : {
          display : false,
        }
      }]
    }
  }

  // This will get the first returned node in the jQuery collection.
  var etsyMonthlySalesChart = new Chart(etsyMonthlySalesChartCanvas, { 
      type: 'line', 
      data: etsyMonthlySalesChartData, 
      options: etsyMonthlySalesChartOptions
    }
  )
  
  }, false);
</script>
{{/contentFor}}